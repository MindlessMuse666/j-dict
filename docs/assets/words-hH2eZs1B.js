import{s as w,f as i,x as p}from"./main-JtOKvQA-.js";const j=w("words",()=>{const a=i([]),f=i(0),c=i(!1),d=i(null),v=i(!0),l=i(0);return{words:a,totalCount:f,loading:c,error:d,hasMore:v,nextCursor:l,fetchWords:async(o=20,s=!1)=>{var r,e;if(!c.value){c.value=!0,d.value=null,s&&(a.value=[],l.value=0,v.value=!0);try{const t={limit:o,cursor:l.value},n=await p.get("/words",{params:t}),{data:u}=n.data;a.value=[...a.value,...u.words],l.value=u.next_cursor,v.value=u.has_more,u.total_count!==void 0&&(f.value=u.total_count)}catch(t){d.value=((e=(r=t.response)==null?void 0:r.data)==null?void 0:e.error)||"Ошибка при загрузке слов",console.error("Ошибка при загрузке слов:",t)}finally{c.value=!1}}},searchWords:async(o={})=>{var s,r;c.value=!0,d.value=null;try{a.value=[],l.value=0,v.value=!0;const e={...o};Array.isArray(e.tags)&&(e.tags=e.tags.join(",")),Array.isArray(e.on)&&(e.on=e.on.join(",")),Array.isArray(e.kun)&&(e.kun=e.kun.join(","));const t=await p.get("/words/search",{params:e,paramsSerializer:{indexes:null}}),{data:n}=t.data;a.value=n.words||[],l.value=n.next_cursor||0,v.value=n.has_more||!1,n.total_count!==void 0&&(f.value=n.total_count)}catch(e){d.value=((r=(s=e.response)==null?void 0:s.data)==null?void 0:r.error)||"Ошибка при поиске слов",console.error("Ошибка при поиске слов:",e)}finally{c.value=!1}},createWord:async o=>{var s,r;try{const t=(await p.post("/words",o)).data.data;return a.value=[t,...a.value],f.value++,{success:!0,word:t}}catch(e){return{success:!1,error:((r=(s=e.response)==null?void 0:s.data)==null?void 0:r.error)||"Ошибка при создании слова"}}},updateWord:async(o,s)=>{var r,e;try{const n=(await p.patch(`/words/${o}`,s)).data.data,u=a.value.findIndex(y=>y.id===o);return u!==-1&&(a.value[u]=n),{success:!0,word:n}}catch(t){return{success:!1,error:((e=(r=t.response)==null?void 0:r.data)==null?void 0:e.error)||"Ошибка при обновлении слова"}}},deleteWord:async o=>{var s,r;try{return await p.delete(`/words/${o}`),a.value=a.value.filter(e=>e.id!==o),f.value--,{success:!0}}catch(e){return{success:!1,error:((r=(s=e.response)==null?void 0:s.data)==null?void 0:r.error)||"Ошибка при удалении слова"}}},clearWords:()=>{a.value=[],l.value=0,v.value=!0,d.value=null}}});export{j as u};
